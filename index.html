<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para mi todo Shitzel</title>

<style>
:root{
  --rosa:#f6d6e2;
  --negro:#111;
}

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body{
  font-family:'Segoe Script','Brush Script MT','Comic Sans MS',cursive;
  background:var(--rosa);
  color:var(--negro);
  overflow:hidden;
}

/* ---------- PANTALLA INICIAL ---------- */
#start{
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:10;
}

#start-heart{
  width:80px;
  height:80px;
  background:#c00;
  transform:rotate(45deg);
  cursor:pointer;
  position:relative;
  animation:pulse 1.5s infinite;
}

#start-heart::before,
#start-heart::after{
  content:"";
  position:absolute;
  width:80px;
  height:80px;
  background:#c00;
  border-radius:50%;
}

#start-heart::before{ top:-40px; left:0; }
#start-heart::after{ left:-40px; top:0; }

#start-text{
  margin-top:20px;
  font-size:22px;
}

@keyframes pulse{
  0%,100%{transform:rotate(45deg) scale(1);}
  50%{transform:rotate(45deg) scale(1.1);}
}

/* ---------- ESCENA ---------- */
#scene{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:flex-end;
  pointer-events:none;
}

#line{
  position:absolute;
  bottom:120px;
  width:70%;
  height:2px;
  background:#000;
  opacity:0;
}

/* ---------- GOTA ---------- */
#drop{
  position:absolute;
  top:50%;
  width:20px;
  height:30px;
  background:#c00;
  border-radius:50% 50% 60% 60%;
  opacity:0;
}

/* ---------- ÁRBOL ---------- */
#tree{
  position:absolute;
  bottom:120px;
  width:200px;
  height:300px;
}

.branch{
  position:absolute;
  bottom:0;
  left:50%;
  width:6px;
  height:0;
  background:#000;
  transform-origin:bottom;
  animation:grow 2s forwards;
}

.branch.left{ transform:rotate(-30deg); }
.branch.right{ transform:rotate(30deg); }

@keyframes grow{
  to{height:180px;}
}

/* ---------- CORAZONES ---------- */
.heart{
  position:absolute;
  width:14px;
  height:14px;
  background:#c00;
  transform:rotate(45deg);
}

.heart::before,
.heart::after{
  content:"";
  position:absolute;
  width:14px;
  height:14px;
  background:#c00;
  border-radius:50%;
}

.heart::before{ top:-7px; left:0; }
.heart::after{ left:-7px; top:0; }

/* ---------- TEXTO ---------- */
#text{
  position:absolute;
  top:15%;
  width:90%;
  text-align:center;
  font-size:20px;
  line-height:1.6;
  white-space:pre-line;
}

.cursor{
  display:inline-block;
  width:2px;
  background:#000;
  animation:blink 1s infinite;
}

@keyframes blink{
  50%{opacity:0;}
}

/* ---------- LLUVIA ---------- */
.fall{
  animation:fall 8s linear infinite;
}

@keyframes fall{
  0%{transform:translate(0,0) rotate(45deg); opacity:1;}
  100%{transform:translate(-200px,600px) rotate(45deg); opacity:0;}
}
</style>
</head>

<body>

<!-- PANTALLA INICIAL -->
<div id="start">
  <div id="start-heart"></div>
  <div id="start-text">San Valentín</div>
</div>

<!-- ESCENA -->
<div id="scene">
  <div id="line"></div>
  <div id="drop"></div>

  <div id="tree">
    <div class="branch"></div>
    <div class="branch left"></div>
    <div class="branch right"></div>
  </div>
</div>

<!-- TEXTO -->
<div id="text"></div>

<audio id="music" src="audio.mp3"></audio>

<script>
const startHeart = document.getElementById('start-heart');
const start = document.getElementById('start');
const drop = document.getElementById('drop');
const line = document.getElementById('line');
const tree = document.getElementById('tree');
const textBox = document.getElementById('text');
const music = document.getElementById('music');

const message = 
`PARA MI TODO SHITZEL

Para la persona que me hizo recordar
cómo se siente el amor:

Si me dieran a elegir el lugar
para estar el resto de mi vida,
sería abrazado a tu cuerpo,
viéndonos a los ojos
por toda la eternidad`;

startHeart.onclick = () => {
  start.style.display='none';

  line.style.opacity=1;

  drop.style.opacity=1;
  drop.animate([
    {top:'50%'},
    {top:'65%'}
  ],{duration:1500,fill:'forwards'});

  setTimeout(()=>{
    document.querySelectorAll('.branch').forEach(b=>{
      b.style.animationPlayState='running';
    });
  },1500);

  setTimeout(()=>{
    createHearts();
    typeText();
    startMusic();
  },3500);
};

function typeText(){
  let i=0;
  textBox.innerHTML='';
  const cursor=document.createElement('span');
  cursor.className='cursor';
  textBox.appendChild(cursor);

  const interval=setInterval(()=>{
    if(i<message.length){
      cursor.insertAdjacentText('beforebegin',message[i]);
      i++;
    }else{
      cursor.remove();
      clearInterval(interval);
    }
  },70);
}

function createHearts(){
  for(let i=0;i<25;i++){
    const h=document.createElement('div');
    h.className='heart fall';
    h.style.left=Math.random()*window.innerWidth+'px';
    h.style.top='-20px';
    h.style.animationDelay=Math.random()*5+'s';
    document.body.appendChild(h);
  }
}

function startMusic(){
  music.currentTime=28;
  music.volume=0;
  music.play();

  let v=0;
  const fade=setInterval(()=>{
    if(v<1){
      v+=0.02;
      music.volume=v;
    }else{
      clearInterval(fade);
    }
  },100);

  setTimeout(()=>{
    music.pause();
  },(72-28)*1000);
}
</script>

</body>
</html>
